
function [out] = gra_tintcolormap(n, varargin);

% Generates a colourmap in TINT colours.
%
%       M = gra_tintcolormap(N);
%       M = gra_tintcolormap(N, 'hi-lite', A);
% 
% Where N is the number of steps.
%
% 'hi-lite' argument will force the colourmap to use colour A 
% (where 1=blue, 49=red) for the second step. This is useful
% to highlight low rate firing. A=12 is a good value.

%%% Look for input options %%%
hi_lite = 0;
if length(varargin)>0
    for ii=1:length(varargin)
        if ischar(varargin{ii})
            if strcmp(varargin{ii}, 'hi-lite')
                hi_lite = 1;
                step2 = varargin{ii+1};
            end
        end
    end
end
%%% N=5, no hi-lite is a special case - match TINT exactly %%
if n==5 && hi_lite==0
    out = [255,255,255; 0, 0, 197; 0,164,254; 60,236,26; 250,219,0; 255,0,0]./255;
else
	%% Select colours from 50-step map %%
    % This is a 50-step tint color set %
    cmap_all =  [ ...
     0     0   198; ...
     0     0   205; ...
     0     0   213; ...
     0     0   221; ...
     0     0   231; ...
     0     5   239; ...
     0    25   244; ...
     0    55   250; ...
     0    80   252; ...
     0   100   253; ...
     0   130   254; ...
     0   150   254; ...
     0   161   255; ...
     0   166   253; ...
     0   171   238; ...
     0   176   223; ...
     0   180   211; ...
     0   186   193; ...
     0   192   179; ...
     0   198   168; ...
     9   207   144; ...
    24   214   117; ...
     8   220    96; ...
    32   229    64; ...
    48   233    42; ...
    68   238    16; ...
    88   243     0; ...
   112   248     0; ...
   136   251     0; ...
   152   253     0; ...
   176   254     0; ...
   196   251     0; ...
   212   249     0; ...
   228   245     0; ...
   237   238     0; ...
   241   232     0; ...
   247   223     0; ...
   251   217     0; ...
   253   210     0; ...
   255   204     0; ...
   255   196     0; ...
   255   189     0; ...
   255   180     0; ...
   255   162     0; ...
   255   147     0; ...
   255   135     0; ...
   255   116     0; ...
   255    80     0; ...
   255    48     0; ...
                ] ./ 255;
    % End color set %              
    n_all = size(cmap_all,1);
    if hi_lite==0;
        ind = [1:n_all/(n-1):n_all];
        ind = [ind, n_all];
        ind = floor(ind);
    elseif hi_lite==1
        ind = [step2:(n_all-step2)/(n-2):n_all];
        ind = [1, ind];
        ind = floor(ind);
    end

    cmap = cmap_all(ind,:);
    out = [1 1 1; cmap];    % White background is 1st step in index
end